<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UiPath Workshop API Interface</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.0/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    
    <style>
        :root {
          --uipath-orange: #ff6900;
          --uipath-purple: #6c5ce7;
          --uipath-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          --success: #00b894;
          --warning: #fdcb6e;
          --danger: #e17055;
          --info: #74b9ff;
          --glass-bg: rgba(255, 255, 255, 0.1);
          --glass-border: rgba(255, 255, 255, 0.2);
          --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
          --transition-normal: 0.25s ease-out;
          --radius-md: 12px;
          --radius-lg: 20px;
          --radius-xl: 30px;
        }

        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        body {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
          background: var(--uipath-gradient);
          min-height: 100vh;
          color: white;
          position: relative;
          overflow-x: hidden;
        }

        .background-animation {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          pointer-events: none;
          z-index: 0;
        }

        .floating-shape {
          position: absolute;
          background: var(--glass-bg);
          border: 1px solid var(--glass-border);
          border-radius: 50%;
          backdrop-filter: blur(10px);
          animation: float 20s ease-in-out infinite;
        }

        .shape-1 { width: 200px; height: 200px; top: 10%; left: 10%; animation-delay: 0s; }
        .shape-2 { width: 150px; height: 150px; top: 70%; right: 10%; animation-delay: -5s; }
        .shape-3 { width: 100px; height: 100px; top: 40%; left: 70%; animation-delay: -10s; }
        .shape-4 { width: 250px; height: 250px; top: 60%; left: 20%; animation-delay: -15s; }

        @keyframes float {
          0%, 100% { transform: translateY(0) rotate(0deg); opacity: 0.3; }
          25% { transform: translateY(-20px) rotate(5deg); opacity: 0.5; }
          50% { transform: translateY(-40px) rotate(-5deg); opacity: 0.3; }
          75% { transform: translateY(-20px) rotate(3deg); opacity: 0.4; }
        }

        .container {
          max-width: 1600px;
          margin: 0 auto;
          padding: 1.5rem;
          position: relative;
          z-index: 1;
        }

        .header {
          text-align: center;
          margin-bottom: 3rem;
        }

        .header-content {
          background: var(--glass-bg);
          backdrop-filter: blur(10px);
          border: 1px solid var(--glass-border);
          border-radius: var(--radius-xl);
          padding: 3rem;
          box-shadow: var(--glass-shadow);
          animation: slideInDown 0.8s ease-out;
        }

        .logo-section {
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 1.5rem;
          margin-bottom: 1.5rem;
        }

        .logo-icon {
          font-size: 4rem;
          animation: pulse 2s ease-in-out infinite;
        }

        .header-title {
          font-size: 3rem;
          font-weight: 700;
          background: linear-gradient(135deg, var(--uipath-orange), var(--uipath-purple));
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
        }

        .header-subtitle {
          font-size: 1.2rem;
          color: rgba(255, 255, 255, 0.9);
          margin-bottom: 2rem;
        }

        .api-status-bar {
          display: flex;
          justify-content: center;
          gap: 2rem;
          background: rgba(0, 0, 0, 0.2);
          padding: 1.5rem;
          border-radius: var(--radius-lg);
          backdrop-filter: blur(5px);
        }

        .status-item {
          text-align: center;
          color: white;
        }

        .status-icon {
          font-size: 1.5rem;
          animation: pulse 1.5s ease-in-out infinite;
        }

        .status-value {
          font-size: 1.1rem;
          font-weight: 600;
          font-family: 'Courier New', monospace;
        }

        .status-label {
          font-size: 0.8rem;
          opacity: 0.8;
          text-transform: uppercase;
          letter-spacing: 1px;
        }

        .main-grid {
          display: grid;
          grid-template-columns: 320px 1fr;
          gap: 2rem;
          min-height: 800px;
          animation: fadeInUp 0.6s ease-out 0.2s both;
        }

        .sidebar {
          background: var(--glass-bg);
          backdrop-filter: blur(10px);
          border: 1px solid var(--glass-border);
          border-radius: var(--radius-lg);
          padding: 2rem;
          box-shadow: var(--glass-shadow);
          height: fit-content;
          position: sticky;
          top: 1.5rem;
        }

        .nav-section {
          margin-bottom: 2rem;
        }

        .nav-heading {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 1rem;
          font-weight: 600;
          color: var(--uipath-orange);
          margin-bottom: 1.5rem;
          text-transform: uppercase;
          letter-spacing: 1px;
        }

        .nav-group {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
        }

        .nav-item {
          display: flex;
          align-items: center;
          gap: 1rem;
          padding: 1rem 1.5rem;
          color: rgba(255, 255, 255, 0.7);
          text-decoration: none;
          border-radius: var(--radius-md);
          transition: all var(--transition-normal);
          cursor: pointer;
        }

        .nav-item:hover {
          background: var(--uipath-orange);
          color: white;
          transform: translateX(8px);
          box-shadow: 0 4px 20px rgba(255, 105, 0, 0.3);
        }

        .nav-item.active {
          background: var(--uipath-orange);
          color: white;
          box-shadow: 0 4px 20px rgba(255, 105, 0, 0.4);
        }

        .content-wrapper {
          background: var(--glass-bg);
          backdrop-filter: blur(10px);
          border: 1px solid var(--glass-border);
          border-radius: var(--radius-lg);
          padding: 3rem;
          box-shadow: var(--glass-shadow);
          min-height: 600px;
          transition: all var(--transition-normal);
        }

        .module-header {
          display: flex;
          align-items: center;
          gap: 1.5rem;
          margin-bottom: 3rem;
          padding-bottom: 1.5rem;
          border-bottom: 2px solid var(--glass-border);
        }

        .module-icon {
          font-size: 3rem;
          animation: bounce 2s ease-in-out infinite;
        }

        .module-title h2 {
          font-size: 2.2rem;
          font-weight: 700;
          color: white;
        }

        .module-description {
          color: rgba(255, 255, 255, 0.8);
        }

        .endpoints-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
          gap: 2rem;
        }

        .endpoint-card {
          background: rgba(255, 255, 255, 0.05);
          backdrop-filter: blur(5px);
          border: 1px solid var(--glass-border);
          border-radius: var(--radius-lg);
          padding: 2rem;
          transition: all var(--transition-normal);
          position: relative;
          overflow: hidden;
        }

        .endpoint-card:hover {
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(-5px);
          box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .endpoint-header {
          display: flex;
          align-items: center;
          gap: 1rem;
          margin-bottom: 1.5rem;
        }

        .method-badge {
          padding: 0.25rem 1rem;
          border-radius: 6px;
          font-size: 0.75rem;
          font-weight: 700;
          text-transform: uppercase;
        }

        .method-get { background: var(--success); color: white; }
        .method-post { background: var(--info); color: white; }
        .method-patch { background: var(--warning); color: black; }

        .endpoint-path {
          font-family: 'Monaco', monospace;
          font-weight: 600;
          color: white;
        }

        .endpoint-description {
          color: rgba(255, 255, 255, 0.8);
          margin-bottom: 1.5rem;
        }

        .input-group {
          margin-bottom: 1.5rem;
        }

        .input-group label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 600;
          color: white;
          font-size: 0.9rem;
        }

        .input-group input,
        .input-group textarea {
          width: 100%;
          padding: 1rem;
          background: rgba(255, 255, 255, 0.05);
          border: 1px solid var(--glass-border);
          border-radius: var(--radius-md);
          color: white;
          transition: all var(--transition-normal);
        }

        .input-group input:focus,
        .input-group textarea:focus {
          outline: none;
          border-color: var(--uipath-orange);
          background: rgba(255, 255, 255, 0.1);
          box-shadow: 0 0 20px rgba(255, 105, 0, 0.2);
        }

        .test-button {
          width: 100%;
          background: linear-gradient(135deg, var(--uipath-orange), #e55a00);
          color: white;
          border: none;
          padding: 1.5rem;
          border-radius: var(--radius-md);
          font-weight: 600;
          cursor: pointer;
          transition: all var(--transition-normal);
        }

        .test-button:hover {
          transform: translateY(-2px);
          box-shadow: 0 8px 25px rgba(255, 105, 0, 0.4);
        }

        .test-button:disabled {
          background: rgba(255, 255, 255, 0.1);
          cursor: not-allowed;
        }

        .response-area {
          margin-top: 1.5rem;
          display: none;
        }

        .response-area.show {
          display: block;
          animation: fadeIn 0.3s ease-out;
        }

        .response-content {
          background: rgba(0, 0, 0, 0.8);
          border: 1px solid var(--glass-border);
          border-radius: var(--radius-md);
          padding: 1.5rem;
          font-family: monospace;
          font-size: 0.85rem;
          max-height: 400px;
          overflow-y: auto;
        }

        .welcome-screen {
          text-align: center;
          padding: 4rem 2rem;
          color: white;
        }

        .welcome-icon {
          font-size: 6rem;
          margin-bottom: 2rem;
          animation: bounce 2s ease-in-out infinite;
        }

        .welcome-screen h2 {
          font-size: 2.5rem;
          font-weight: 700;
          margin-bottom: 1.5rem;
        }

        .scenario-cards {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
          gap: 2rem;
          margin-top: 3rem;
        }

        .scenario-card {
          background: var(--glass-bg);
          backdrop-filter: blur(10px);
          border: 1px solid var(--glass-border);
          border-radius: var(--radius-lg);
          padding: 2rem;
          cursor: pointer;
          transition: all var(--transition-normal);
        }

        .scenario-card:hover {
          transform: translateY(-8px);
          box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
          border-color: var(--uipath-orange);
        }

        .scenario-card h4 {
          color: var(--uipath-orange);
          margin-bottom: 1rem;
          font-size: 1.3rem;
        }

        .stats-bar {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
          gap: 1.5rem;
          background: rgba(0, 0, 0, 0.3);
          padding: 2rem;
          border-radius: var(--radius-lg);
          margin-bottom: 2rem;
        }

        .stat-number {
          font-size: 2.5rem;
          font-weight: 800;
          display: block;
          background: linear-gradient(135deg, var(--uipath-orange), var(--uipath-purple));
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
        }

        .fab {
          position: fixed;
          bottom: 2rem;
          right: 2rem;
          width: 60px;
          height: 60px;
          background: linear-gradient(135deg, var(--uipath-orange), var(--uipath-purple));
          border: none;
          border-radius: 50%;
          cursor: pointer;
          box-shadow: 0 8px 25px rgba(255, 105, 0, 0.4);
          z-index: 1000;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .quick-actions {
          position: fixed;
          bottom: 100px;
          right: 2rem;
          display: flex;
          flex-direction: column;
          gap: 1rem;
          opacity: 0;
          visibility: hidden;
          z-index: 999;
        }

        .quick-actions.show {
          opacity: 1;
          visibility: visible;
        }

        .quick-action {
          display: flex;
          align-items: center;
          gap: 1rem;
          background: var(--glass-bg);
          backdrop-filter: blur(10px);
          border: 1px solid var(--glass-border);
          border-radius: var(--radius-md);
          padding: 1rem 1.5rem;
          color: white;
          cursor: pointer;
          transition: all 0.15s ease-out;
        }

        .quick-action:hover {
          background: var(--uipath-orange);
        }

        .loading {
          display: inline-block;
          width: 20px;
          height: 20px;
          border: 3px solid rgba(255, 255, 255, 0.3);
          border-radius: 50%;
          border-top-color: white;
          animation: spin 1s linear infinite;
        }

        .loading-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.8);
          backdrop-filter: blur(5px);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 9999;
          opacity: 0;
          visibility: hidden;
        }

        .loading-overlay.show {
          opacity: 1;
          visibility: visible;
        }

        .toast-container {
          position: fixed;
          top: 2rem;
          right: 2rem;
          z-index: 9998;
        }

        .toast {
          background: var(--glass-bg);
          backdrop-filter: blur(10px);
          border: 1px solid var(--glass-border);
          border-radius: var(--radius-md);
          padding: 1.5rem;
          color: white;
          margin-bottom: 1rem;
          transform: translateX(100%);
          transition: transform var(--transition-normal);
        }

        .toast.show {
          transform: translateX(0);
        }

        .toast.success { border-left: 4px solid var(--success); }
        .toast.error { border-left: 4px solid var(--danger); }
        .toast.warning { border-left: 4px solid var(--warning); }

        @keyframes slideInDown {
          from { opacity: 0; transform: translateY(-50px); }
          to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp {
          from { opacity: 0; transform: translateY(30px); }
          to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        @keyframes pulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.05); }
        }

        @keyframes bounce {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-10px); }
        }

        @media (max-width: 768px) {
          .main-grid {
            grid-template-columns: 1fr;
          }
          
          .header-title {
            font-size: 2rem;
          }
          
          .scenario-cards {
            grid-template-columns: 1fr;
          }
        }
    </style>
</head>
<body>
    <div class="background-animation">
        <div class="floating-shape shape-1"></div>
        <div class="floating-shape shape-2"></div>
        <div class="floating-shape shape-3"></div>
        <div class="floating-shape shape-4"></div>
    </div>

    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo-icon">🚀</div>
                    <h1 class="header-title">UiPath Workshop API</h1>
                </div>
                <p class="header-subtitle">Enterprise-grade API testing environment</p>
                
                <div class="api-status-bar">
                    <div class="status-item">
                        <div class="status-icon" id="connection-status">⚡</div>
                        <span class="status-label">Connection</span>
                    </div>
                    <div class="status-item">
                        <div class="status-value" id="api-url-display">Loading...</div>
                        <span class="status-label">API Endpoint</span>
                    </div>
                    <div class="status-item">
                        <div class="status-value" id="response-time">--ms</div>
                        <span class="status-label">Response Time</span>
                    </div>
                </div>
            </div>
        </header>
<main class="main-grid">
            <nav class="sidebar">
                <div class="nav-section">
                    <h3 class="nav-heading">
                        <span class="nav-icon">🏠</span>
                        Overview
                    </h3>
                    <div class="nav-group">
                        <a href="#" class="nav-item active" data-module="welcome">
                            <span class="nav-item-icon">👋</span>
                            <span class="nav-item-text">Welcome</span>
                        </a>
                        <a href="#" class="nav-item" data-module="stats">
                            <span class="nav-item-icon">📊</span>
                            <span class="nav-item-text">Statistics</span>
                        </a>
                    </div>
                </div>

                <div class="nav-section">
                    <h3 class="nav-heading">
                        <span class="nav-icon">👥</span>
                        HR Module
                    </h3>
                    <div class="nav-group">
                        <a href="#" class="nav-item" data-module="hr-workers">
                            <span class="nav-item-icon">👤</span>
                            <span class="nav-item-text">Workers</span>
                        </a>
                        <a href="#" class="nav-item" data-module="hr-onboarding">
                            <span class="nav-item-icon">🎯</span>
                            <span class="nav-item-text">Onboarding</span>
                        </a>
                    </div>
                </div>

                <div class="nav-section">
                    <h3 class="nav-heading">
                        <span class="nav-icon">💰</span>
                        Finance
                    </h3>
                    <div class="nav-group">
                        <a href="#" class="nav-item" data-module="finance-invoices">
                            <span class="nav-item-icon">📄</span>
                            <span class="nav-item-text">Invoices</span>
                        </a>
                        <a href="#" class="nav-item" data-module="finance-expenses">
                            <span class="nav-item-icon">💳</span>
                            <span class="nav-item-text">Expenses</span>
                        </a>
                    </div>
                </div>

                <div class="nav-section">
                    <h3 class="nav-heading">
                        <span class="nav-icon">🤝</span>
                        CRM
                    </h3>
                    <div class="nav-group">
                        <a href="#" class="nav-item" data-module="crm-customers">
                            <span class="nav-item-icon">🏢</span>
                            <span class="nav-item-text">Customers</span>
                        </a>
                        <a href="#" class="nav-item" data-module="crm-sales">
                            <span class="nav-item-icon">💼</span>
                            <span class="nav-item-text">Sales</span>
                        </a>
                    </div>
                </div>

                <div class="nav-section">
                    <h3 class="nav-heading">
                        <span class="nav-icon">🔌</span>
                        IoT
                    </h3>
                    <div class="nav-group">
                        <a href="#" class="nav-item" data-module="iot-devices">
                            <span class="nav-item-icon">📱</span>
                            <span class="nav-item-text">Devices</span>
                        </a>
                        <a href="#" class="nav-item" data-module="iot-maintenance">
                            <span class="nav-item-icon">🔧</span>
                            <span class="nav-item-text">Maintenance</span>
                        </a>
                    </div>
                </div>
            </nav>

            <div class="content-area">
                <div class="content-wrapper" id="content-area">
                    <!-- Dynamic content loaded here -->
                </div>
                
                <button class="fab" id="fab" title="Quick Actions">
                    <span class="fab-icon">⚡</span>
                </button>
                
                <div class="quick-actions" id="quick-actions">
                    <button class="quick-action" onclick="testAllEndpoints()">
                        <span>🧪</span>
                        <span>Test All</span>
                    </button>
                    <button class="quick-action" onclick="refreshData()">
                        <span>🔄</span>
                        <span>Refresh</span>
                    </button>
                    <button class="quick-action" onclick="exportResults()">
                        <span>📤</span>
                        <span>Export</span>
                    </button>
                </div>
            </div>
        </main>

        <div class="toast-container" id="toast-container"></div>
    </div>

    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner">
            <div style="width: 80px; height: 80px; border: 4px solid rgba(255,255,255,0.1); border-radius: 50%; border-top-color: #ff6900; animation: spin 1s linear infinite; margin: 0 auto 1.5rem;"></div>
            <div class="spinner-text">Loading...</div>
        </div>
    </div>
<script>
        // UiPath Workshop API Interface - Core Logic
        const state = {
          apiBase: window.location.origin + '/api',
          currentModule: 'welcome',
          sampleIds: { worker: null, invoice: null, customer: null, device: null, opportunity: null },
          apiHealth: { isOnline: false, responseTime: 0, lastCheck: null },
          testResults: { passed: 0, failed: 0, total: 0 }
        };

        const modules = {
          welcome: {
            content: () => `
              <div class="welcome-screen">
                <div class="welcome-icon">🚀</div>
                <h2>UiPath Workshop API</h2>
                <p>Enterprise-grade API deployed globally for UiPath workflow demonstrations!</p>
                <p style="margin-top: 15px;"><strong>Live API:</strong> <code>${state.apiBase}</code></p>
                
                <div class="scenario-cards">
                  <div class="scenario-card" onclick="loadScenarioEndpoints('employee-onboarding')">
                    <h4>👥 Employee Onboarding</h4>
                    <p>Track progress and identify bottlenecks</p>
                  </div>
                  <div class="scenario-card" onclick="loadScenarioEndpoints('invoice-approval')">
                    <h4>💰 Invoice Approval</h4>
                    <p>Automate routing with risk assessment</p>
                  </div>
                  <div class="scenario-card" onclick="loadScenarioEndpoints('customer-health')">
                    <h4>🎯 Customer Health</h4>
                    <p>Analyze risk factors and relationships</p>
                  </div>
                  <div class="scenario-card" onclick="loadScenarioEndpoints('iot-maintenance')">
                    <h4>🔧 IoT Maintenance</h4>
                    <p>Optimize schedules and prevent failures</p>
                  </div>
                  <div class="scenario-card" onclick="loadScenarioEndpoints('sales-intelligence')">
                    <h4>📊 Sales Intelligence</h4>
                    <p>Forecast pipeline and prioritize deals</p>
                  </div>
                </div>
              </div>
            `
          },
          stats: {
            content: async () => {
              let healthData = { api: { endpoints: 87, collections: 26, totalRecords: 728 } };
              
              try {
                const response = await axios.get(`${state.apiBase.replace('/api', '')}/health`);
                healthData = response.data;
              } catch (error) {
                console.warn('Health data fetch failed:', error);
              }

              return `
                <div class="stats-bar">
                  <div class="stat-item">
                    <span class="stat-number">${healthData.api?.endpoints || '87'}</span>
                    <span class="stat-label">Endpoints</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-number">${healthData.api?.collections || '26'}</span>
                    <span class="stat-label">Collections</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-number">${healthData.api?.totalRecords || '728'}</span>
                    <span class="stat-label">Records</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-number">${state.apiHealth.isOnline ? '🟢' : '🔴'}</span>
                    <span class="stat-label">Status</span>
                  </div>
                </div>
                <div style="text-align: center; color: white; margin-top: 30px;">
                  <h3>🌐 Production API Status</h3>
                  <p>Enterprise capabilities with ${state.apiHealth.responseTime}ms response time</p>
                </div>
              `;
            }
          },
          'hr-workers': {
            title: 'HR Workers Management',
            icon: '👥',
            description: 'Employee records and organizational hierarchy',
            endpoints: [
              { method: 'GET', path: '/hr/workers', description: 'Get all workers' },
              { method: 'GET', path: '/hr/workers/:id', description: 'Get specific worker', needsId: 'worker' },
              { method: 'GET', path: '/hr/workers/:id/directReports', description: 'Get direct reports', needsId: 'worker' }
            ]
          },
          'hr-onboarding': {
            title: 'HR Onboarding Management', 
            icon: '🎯',
            description: 'Employee onboarding tracking',
            endpoints: [
              { method: 'GET', path: '/hr/onboarding', description: 'Get all onboarding records' },
              { method: 'GET', path: '/hr/org/headcount', description: 'Get department headcount' }
            ]
          },
          'finance-invoices': {
            title: 'Finance Invoice Management',
            icon: '📄',
            description: 'Invoice processing and approval',
            endpoints: [
              { method: 'GET', path: '/finance/invoices', description: 'Get all invoices' },
              { method: 'GET', path: '/finance/invoices/:id', description: 'Get specific invoice', needsId: 'invoice' },
              { method: 'PATCH', path: '/finance/invoices/:id/approve', description: 'Approve invoice', needsId: 'invoice', body: {status: 'approved'} }
            ]
          },
          'finance-expenses': {
            title: 'Finance Expense Management',
            icon: '💳',
            description: 'Expense reports and reimbursement',
            endpoints: [
              { method: 'GET', path: '/finance/expenses', description: 'Get all expenses' },
              { method: 'POST', path: '/finance/expenses', description: 'Create expense', body: {workerId: '', description: 'Conference', amount: 450, currency: 'USD'} }
            ]
          },
          'crm-customers': {
            title: 'CRM Customer Management',
            icon: '🏢', 
            description: 'Customer records and relationships',
            endpoints: [
              { method: 'GET', path: '/crm/customers', description: 'Get all customers' },
              { method: 'GET', path: '/crm/customers/:id', description: 'Get specific customer', needsId: 'customer' },
              { method: 'GET', path: '/analytics/customer/relationships', description: 'Get relationships' }
            ]
          },
          'crm-sales': {
            title: 'CRM Sales & Opportunities',
            icon: '💼',
            description: 'Sales pipeline and forecasting',
            endpoints: [
              { method: 'GET', path: '/crm/opportunities', description: 'Get opportunities' },
              { method: 'GET', path: '/crm/pipeline/forecast', description: 'Get pipeline forecast' },
              { method: 'PATCH', path: '/crm/opportunities/:id/score', description: 'Score opportunity', needsId: 'opportunity', body: {score: 85} }
            ]
          },
          'iot-devices': {
            title: 'IoT Device Management',
            icon: '📱',
            description: 'Device inventory and monitoring',
            endpoints: [
              { method: 'GET', path: '/iot/devices', description: 'Get all devices' },
              { method: 'GET', path: '/iot/devices/:id', description: 'Get specific device', needsId: 'device' },
              { method: 'GET', path: '/iot/devices/:id/telemetry', description: 'Get device telemetry', needsId: 'device' }
            ]
          },
          'iot-maintenance': {
            title: 'IoT Maintenance & Alerts',
            icon: '🔧',
            description: 'Maintenance and alerts',
            endpoints: [
              { method: 'GET', path: '/iot/alerts', description: 'Get all alerts' },
              { method: 'GET', path: '/iot/maintenance', description: 'Get maintenance schedule' }
            ]
          }
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', async function() {
          document.getElementById('api-url-display').textContent = state.apiBase;
          setupNavigation();
          setupFloatingActionButton();
          await checkApiHealth();
          await loadSampleIds();
          await renderModule('welcome');
          startHealthMonitoring();
        });

        function setupNavigation() {
          document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function(e) {
              e.preventDefault();
              const moduleKey = this.getAttribute('data-module');
              if (moduleKey) setActiveModule(moduleKey);
            });
          });
        }

        function setActiveModule(moduleKey) {
          document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active');
          });
          
          const activeItem = document.querySelector(`[data-module="${moduleKey}"]`);
          if (activeItem) activeItem.classList.add('active');

          state.currentModule = moduleKey;
          renderModule(moduleKey);
        }

        async function renderModule(moduleKey) {
          const module = modules[moduleKey];
          const contentArea = document.getElementById('content-area');
          
          if (!module) return;

          contentArea.style.opacity = '0';
          
          setTimeout(async () => {
            let content = '';
            
            if (typeof module.content === 'function') {
              content = await module.content();
            } else if (module.endpoints) {
              content = `
                <div class="module-header">
                  <div class="module-icon">${module.icon}</div>
                  <div class="module-title">
                    <h2>${module.title}</h2>
                    <div class="module-description">${module.description}</div>
                  </div>
                </div>
                <div class="endpoints-grid">
                  ${module.endpoints.map((endpoint, index) => 
                    renderEndpointCard(endpoint, `${state.currentModule}-${index}`)
                  ).join('')}
                </div>
              `;
            }
            
            contentArea.innerHTML = content;
            contentArea.style.opacity = '1';
          }, 150);
        }

        function renderEndpointCard(endpoint, cardId) {
          const methodClass = `method-${endpoint.method.toLowerCase()}`;
          const hasBody = endpoint.body || endpoint.method === 'POST' || endpoint.method === 'PATCH';
          const needsParam = endpoint.needsId;

          return `
            <div class="endpoint-card">
              <div class="endpoint-header">
                <span class="method-badge ${methodClass}">${endpoint.method}</span>
                <span class="endpoint-path">${endpoint.path}</span>
              </div>
              <div class="endpoint-description">${endpoint.description}</div>
              
              ${needsParam ? `
                <div class="input-group">
                  <label>${endpoint.needsId.toUpperCase()} ID:</label>
                  <input type="text" id="param-${cardId}" placeholder="Auto-filled">
                </div>
              ` : ''}
              
              ${hasBody ? `
                <div class="input-group">
                  <label>Request Body:</label>
                  <textarea id="body-${cardId}">${JSON.stringify(endpoint.body || {}, null, 2)}</textarea>
                </div>
              ` : ''}
              
              <button class="test-button" onclick="testEndpoint('${cardId}', '${endpoint.method}', '${endpoint.path}', ${!!needsParam}, ${!!hasBody})">
                Test Endpoint 🚀
              </button>
              
              <div class="response-area" id="response-${cardId}">
                <div class="response-content" id="response-content-${cardId}"></div>
              </div>
            </div>
          `;
        }
async function testEndpoint(cardId, method, path, needsParam, hasBody) {
          const button = document.querySelector(`#card-${cardId} .test-button`);
          const responseArea = document.getElementById(`response-${cardId}`);
          const responseContent = document.getElementById(`response-content-${cardId}`);
          
          button.disabled = true;
          button.innerHTML = '<span class="loading"></span> Testing...';
          responseArea.style.display = 'block';
          responseArea.classList.add('show');

          let finalPath = path;
          let requestBody = null;
          const startTime = performance.now();

          try {
            if (needsParam) {
              const paramInput = document.getElementById(`param-${cardId}`);
              let paramValue = paramInput.value.trim();
              
              if (!paramValue) {
                paramValue = await getSampleId(needsParam);
                if (paramValue) paramInput.value = paramValue;
              }

              if (paramValue) {
                finalPath = path.replace(':id', paramValue);
              } else {
                throw new Error(`${needsParam.toUpperCase()} ID required`);
              }
            }

            if (hasBody) {
              const bodyInput = document.getElementById(`body-${cardId}`);
              if (bodyInput.value.trim()) {
                requestBody = JSON.parse(bodyInput.value);
                
                if (requestBody.workerId === '' && state.sampleIds.worker) {
                  requestBody.workerId = state.sampleIds.worker;
                  bodyInput.value = JSON.stringify(requestBody, null, 2);
                }
              }
            }

            const config = {
              method: method,
              url: `${state.apiBase}${finalPath}`,
              headers: { 'Content-Type': 'application/json' }
            };

            if (requestBody) config.data = requestBody;

            const response = await axios(config);
            const responseTime = Math.round(performance.now() - startTime);

            state.testResults.passed++;
            state.testResults.total++;

            const dataLength = Array.isArray(response.data) ? response.data.length : 'Object';
            responseContent.innerHTML = `
              <div style="color: #00ff88; margin-bottom: 10px; font-weight: 600;">
                ✅ ${response.status} ${response.statusText}
              </div>
              <div style="color: #74b9ff; margin-bottom: 15px;">
                📊 Records: ${dataLength} | ⚡ ${responseTime}ms | 🕐 ${new Date().toLocaleTimeString()}
              </div>
              <div style="color: #fdcb6e; margin-bottom: 10px;">📋 Response:</div>
              <pre><code class="language-json">${JSON.stringify(response.data, null, 2)}</code></pre>
            `;
            
            if (window.Prism) window.Prism.highlightAllUnder(responseContent);
            showToast(`${method} ${path} - Success`, 'success');

          } catch (error) {
            const responseTime = Math.round(performance.now() - startTime);
            state.testResults.failed++;
            state.testResults.total++;

            const status = error.response?.status || 'Network Error';
            responseContent.innerHTML = `
              <div style="color: #ff6b6b; margin-bottom: 10px; font-weight: 600;">
                ❌ Error: ${status}
              </div>
              <div style="color: #74b9ff; margin-bottom: 15px;">
                ⚡ ${responseTime}ms | 🕐 ${new Date().toLocaleTimeString()}
              </div>
              <div style="color: #fdcb6e; margin-bottom: 10px;">🔍 Details:</div>
              <pre><code class="language-json">${error.response ? 
                JSON.stringify(error.response.data, null, 2) : 
                JSON.stringify({message: error.message}, null, 2)}</code></pre>
            `;
            
            if (window.Prism) window.Prism.highlightAllUnder(responseContent);
            showToast(`${method} ${path} - Failed`, 'error');
          }

          button.disabled = false;
          button.innerHTML = 'Test Endpoint 🚀';
        }

        async function getSampleId(type) {
          if (state.sampleIds[type]) return state.sampleIds[type];

          const endpoints = {
            worker: '/hr/workers',
            invoice: '/finance/invoices', 
            customer: '/crm/customers',
            device: '/iot/devices',
            opportunity: '/crm/opportunities'
          };

          try {
            const response = await axios.get(`${state.apiBase}${endpoints[type]}`);
            if (response.data && response.data.length > 0) {
              state.sampleIds[type] = response.data[0].id;
              return state.sampleIds[type];
            }
          } catch (error) {
            console.warn(`Could not fetch ${type} ID:`, error);
          }
          return null;
        }

        async function loadSampleIds() {
          await Promise.all(Object.keys(state.sampleIds).map(type => getSampleId(type)));
        }

        function loadScenarioEndpoints(scenario) {
          const scenarioMappings = {
            'employee-onboarding': 'hr-onboarding',
            'invoice-approval': 'finance-invoices', 
            'customer-health': 'crm-customers',
            'iot-maintenance': 'iot-devices',
            'sales-intelligence': 'crm-sales'
          };

          const module = scenarioMappings[scenario];
          if (module) {
            setActiveModule(module);
            showToast(`Loaded ${scenario.replace('-', ' ')} scenario`, 'success');
          }
        }

        async function checkApiHealth() {
          const startTime = performance.now();
          
          try {
            const response = await axios.get(`${state.apiBase.replace('/api', '')}/health`);
            const responseTime = Math.round(performance.now() - startTime);
            
            state.apiHealth = {
              isOnline: true,
              responseTime: responseTime,
              lastCheck: new Date()
            };
            
            const statusEl = document.getElementById('connection-status');
            const timeEl = document.getElementById('response-time');
            
            if (statusEl) {
              statusEl.textContent = '⚡';
              statusEl.style.color = '#00b894';
            }
            
            if (timeEl) {
              timeEl.textContent = `${responseTime}ms`;
              timeEl.style.color = responseTime < 100 ? '#00b894' : '#fdcb6e';
            }
            
          } catch (error) {
            state.apiHealth.isOnline = false;
            const statusEl = document.getElementById('connection-status');
            if (statusEl) {
              statusEl.textContent = '❌';
              statusEl.style.color = '#e17055';
            }
          }
        }

        function setupFloatingActionButton() {
          const fab = document.getElementById('fab');
          const quickActions = document.getElementById('quick-actions');
          let isOpen = false;

          fab.addEventListener('click', () => {
            isOpen = !isOpen;
            quickActions.classList.toggle('show', isOpen);
          });

          document.addEventListener('click', (e) => {
            if (!fab.contains(e.target) && !quickActions.contains(e.target) && isOpen) {
              isOpen = false;
              quickActions.classList.remove('show');
            }
          });
        }

        async function testAllEndpoints() {
          showLoadingOverlay('Testing endpoints...');
          
          const endpoints = ['/hr/workers', '/finance/invoices', '/crm/customers', '/iot/devices'];
          let passed = 0, failed = 0;

          for (const endpoint of endpoints) {
            try {
              await axios.get(`${state.apiBase}${endpoint}`);
              passed++;
            } catch (error) {
              failed++;
            }
          }

          hideLoadingOverlay();
          showToast(`Test complete: ${passed} passed, ${failed} failed`, 'success');
        }

        async function refreshData() {
          showLoadingOverlay('Refreshing...');
          await checkApiHealth();
          await loadSampleIds();
          await renderModule(state.currentModule);
          hideLoadingOverlay();
          showToast('Refreshed!', 'success');
        }

        function exportResults() {
          const results = {
            timestamp: new Date().toISOString(),
            apiBase: state.apiBase,
            health: state.apiHealth,
            testResults: state.testResults
          };

          const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `uipath-results-${new Date().toISOString().split('T')[0]}.json`;
          a.click();
          URL.revokeObjectURL(url);
          showToast('Results exported!', 'success');
        }

        function showLoadingOverlay(message) {
          const overlay = document.getElementById('loading-overlay');
          overlay.querySelector('.spinner-text').textContent = message;
          overlay.classList.add('show');
        }

        function hideLoadingOverlay() {
          document.getElementById('loading-overlay').classList.remove('show');
        }

        function showToast(message, type = 'info') {
          const container = document.getElementById('toast-container');
          const toast = document.createElement('div');
          toast.className = `toast ${type}`;
          
          const icons = { success: '✅', error: '❌', warning: '⚠️', info: 'ℹ️' };
          
          toast.innerHTML = `
            <div style="display: flex; align-items: center; gap: 10px;">
              <span>${icons[type]}</span>
              <span>${message}</span>
            </div>
          `;
          
          container.appendChild(toast);
          setTimeout(() => toast.classList.add('show'), 100);
          setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => container.removeChild(toast), 300);
          }, 3000);
        }

        function startHealthMonitoring() {
          setInterval(checkApiHealth, 30000);
          setTimeout(checkApiHealth, 2000);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
          if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
            e.preventDefault();
            refreshData();
          }
        });

        console.log('%c🚀 UiPath Workshop API Interface Ready!', 'color: #ff6900; font-size: 16px; font-weight: bold;');
    </script>
</body>
</html>